<?xml version="1.0"?>
<Denemo>
  <merge>
    <title>A Denemo Keymap</title>
    <author>AT, JRR, RTS</author>
    <map>
      <row>
        <after>ScoreBlockProlog</after>
        <action>LilyPondInclude</action>
        <scheme>;;;RefreshDynamicDirectives
(let loop ((number 0))
  (define tag (d-DirectiveGetNthTag-score number))
  (if tag
    (let ((index (string-index tag #\:)) (command #f)) 
    	(if index
    		(set! command (substring tag 0 index))
    		(set! command tag))
      (set! command (string-append "d-" command))
      (disp "looking at " tag "and " command "\n")
      (if (positive? (logand (d-DirectiveGet-score-override tag) DENEMO_OVERRIDE_DYNAMIC))
	(let ((sym (string-&gt;symbol command)))
		(if (defined? sym)
	 		 (eval-string command))))
      (loop (+ 1 number)))))
;;; FIXME there are 13 other types of directive to refresh ,,,      
</scheme>
        <label>LilyPond Include File</label>
        <tooltip>Allows specification of a LilyPond include file from the Denemo provided include files.</tooltip>
      </row>
    </map>
  </merge>
</Denemo>
